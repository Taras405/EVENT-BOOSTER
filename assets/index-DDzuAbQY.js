(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();const l="",p="https://app.ticketmaster.com/discovery/v2",g="BIqpeJSCCVibv6jIhfaVoFVpuL0cSADG",f=e=>{const t=new URLSearchParams({apikey:g});return Object.entries(e).forEach(([n,s])=>{s==null||s===""||t.set(n,String(s))}),t.toString()},m=async(e,t={})=>{const n=await fetch(`${p}${e}?${f(t)}`);if(!n.ok)throw new Error(`Ticketmaster API error: ${n.status}`);return n.json()},y=async({page:e=1,size:t=20,keyword:n="",countryCode:s="",city:r=""}={})=>{const a=await m("/events",{page:Math.max(0,Number(e)-1),size:t,keyword:n,countryCode:s,city:r,sort:"date,asc"}),c=a?._embedded?.events??[],u=a?.page??{};return{events:c,pagination:{currentPage:(u.number??0)+1,totalPages:u.totalPages??1,totalElements:u.totalElements??c.length,size:u.size??t}}},i={list:document.querySelector("[data-events-list]"),pagination:document.querySelector("[data-pagination]")},o={page:1,size:20,totalPages:1},h=e=>{if(!e)return"Date unavailable";const t=new Date(e);return Number.isNaN(t.getTime())?e:new Intl.DateTimeFormat("uk-UA",{year:"numeric",month:"2-digit",day:"2-digit"}).format(t)},b=e=>{if(!Array.isArray(e)||e.length===0)return"";const t=[...e].sort((n,s)=>{const r=(n.width||0)*(n.height||0);return(s.width||0)*(s.height||0)-r});return t[0]&&t[0].url?t[0].url:""},P=e=>!e||!e._embedded||!Array.isArray(e._embedded.venues)?null:e._embedded.venues[0]||null,L=e=>e.map(t=>{const n=P(t);return{id:t&&t.id?t.id:"",name:t&&t.name?t.name:"Untitled event",image:b(t?t.images:[]),date:h(t&&t.dates&&t.dates.start?t.dates.start.dateTime||t.dates.start.localDate:""),location:[n&&n.city?n.city.name:"",n&&n.country?n.country.name:"",n?n.name:""].filter(Boolean).join(", ")}}),E=(e,t)=>{if(t<=7)return Array.from({length:t},(a,c)=>c+1);const n=[1],s=Math.max(2,e-2),r=Math.min(t-1,e+2);s>2&&n.push("...");for(let a=s;a<=r;a+=1)n.push(a);return r<t-1&&n.push("..."),n.push(t),n},A=()=>{if(i.pagination){if(o.totalPages<=1){i.pagination.innerHTML="";return}i.pagination.innerHTML=E(o.page,o.totalPages).map(e=>{if(e==="...")return'<span class="pagination__dots">...</span>';const t=e===o.page?'class="is-active" aria-current="page"':"";return`<button type="button" data-page="${e}" ${t}>${e}</button>`}).join("")}},M=e=>{if(i.list){if(!e||e.length===0){i.list.innerHTML="<p>No events found.</p>";return}i.list.innerHTML=l(L(e))}},d=async()=>{if(i.list){i.list.innerHTML="<p>Loading events...</p>";try{const e=await y({page:o.page,size:o.size});o.totalPages=e.pagination.totalPages,M(e.events),A()}catch(e){i.list.innerHTML=`<p>${e.message}</p>`,i.pagination&&(i.pagination.innerHTML="")}}},S=e=>{const t=e.target.closest("[data-page]");if(!t)return;const n=Number(t.dataset.page);!n||n===o.page||(o.page=n,d())},w=()=>{i.list&&(i.pagination?.addEventListener("click",S),d())};w();
